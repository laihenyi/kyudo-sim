<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <title>Kyudo Animation Prototype (Vector Style)</title>
    <style>
        body {
            background: #333;
            color: #fff;
            font-family: sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }

        #preview-container {
            width: 400px;
            height: 400px;
            background: #222;
            border: 4px solid #e67e22;
            border-radius: 8px;
            position: relative;
        }

        /* Vector Style Definitions */
        .skin {
            fill: #f1c27d;
            stroke: #dbb070;
            stroke-width: 1;
        }

        .gi {
            fill: #ffffff;
            stroke: #ccc;
            stroke-width: 1;
        }

        .hakama {
            fill: #1a1a1a;
            stroke: #000;
            stroke-width: 1;
        }

        .tabi {
            fill: #fff;
            stroke: #ccc;
            stroke-width: 1;
        }

        .bow {
            fill: none;
            stroke: #d2691e;
            stroke-width: 4;
            stroke-linecap: round;
        }

        .string {
            stroke: #fff;
            stroke-width: 1;
            opacity: 0.8;
        }

        .hair {
            fill: #111;
        }

        .ctrl {
            margin-top: 20px;
            text-align: center;
        }

        button {
            padding: 10px 20px;
            font-size: 1rem;
            cursor: pointer;
            background: #e67e22;
            border: none;
            color: white;
            border-radius: 4px;
        }

        button:hover {
            background: #d35400;
        }
    </style>
</head>

<body>
    <h2>Animation Upgrade Prototype</h2>
    <div id="preview-container">
        <svg viewBox="0 0 300 300" preserveAspectRatio="xMidYMid meet">
            <defs>
                <linearGradient id="floorGrad" x1="0" y1="0" x2="0" y2="1">
                    <stop offset="0%" stop-color="#444" />
                    <stop offset="100%" stop-color="#333" />
                </linearGradient>
            </defs>
            <rect width="300" height="300" fill="#333" />
            <rect y="250" width="300" height="50" fill="url(#floorGrad)" />

            <!-- Archer Group -->
            <g id="archer" transform="translate(150, 250)">
                <!-- LEGS (Static for now, as Ashibumi is wide) -->
                <g id="legs">
                    <!-- Left Leg -->
                    <path d="M-10,-60 L-25,0 L-5,0 L5,-60 Z" class="hakama" />
                    <path d="M-25,0 L-35,5 L-15,5 Z" class="tabi" />
                    <!-- Right Leg -->
                    <path d="M10,-60 L25,0 L5,0 L-5,-60 Z" class="hakama" />
                    <path d="M25,0 L35,5 L15,5 Z" class="tabi" />
                    <!-- Hakama Main Body -->
                    <path d="M-15,-90 L-20,-50 L20,-50 L15,-90 Z" class="hakama" />
                </g>

                <!-- TORSO -->
                <g id="torso" transform="translate(0, -90)">
                    <path d="M-18,0 L-22,-70 L22,-70 L18,0 Z" class="gi" />
                    <path d="M-22,-70 L0,-85 L22,-70" fill="none" stroke="#ddd" stroke-width="1" /> <!-- Collar hint -->

                    <!-- HEAD -->
                    <g id="head" transform="translate(0, -80)">
                        <circle cx="0" cy="-5" r="12" class="skin" />
                        <path d="M-12,-10 Q0,-20 12,-10 L12,-5 Q0,-15 -12,-5 Z" class="hair" /> <!-- Simple hair -->
                        <path d="M12,-5 L16,-2 L12,1" fill="none" stroke="#dbb070" stroke-width="1" /> <!-- Nose -->
                    </g>

                    <!-- LEFT ARM (Bow Hand) -->
                    <g id="arm-l" transform="translate(15, -65)">
                        <!-- Upper Arm -->
                        <path d="M0,0 L5,30 L-5,30 Z" class="gi" />
                        <g id="fore-l" transform="translate(0, 30)">
                            <!-- Forearm -->
                            <path d="M0,0 L4,25 L-4,25 Z" class="skin" />
                            <!-- Hand -->
                            <circle cx="0" cy="28" r="5" class="skin" />
                            <!-- BOW -->
                            <g id="bow-grp" transform="translate(0, 28)">
                                <path id="bow-shape" d="M0,-120 Q0,0 0,80" class="bow" />
                                <path id="bow-string" d="M0,-120 L0,80" class="string" />
                            </g>
                        </g>
                    </g>

                    <!-- RIGHT ARM (Draw Hand) -->
                    <g id="arm-r" transform="translate(-15, -65)">
                        <!-- Upper Arm -->
                        <path d="M0,0 L5,30 L-5,30 Z" class="gi" />
                        <g id="fore-r" transform="translate(0, 30)">
                            <!-- Forearm -->
                            <path d="M0,0 L4,25 L-4,25 Z" class="skin" />
                            <!-- Hand (Glove/Yugake) -->
                            <circle cx="0" cy="28" r="6" fill="#8d6e63" />
                        </g>
                    </g>
                </g>
            </g>
        </svg>
    </div>
    <div class="ctrl">
        <p>Prototype: Vector Mannequin Style</p>
        <button onclick="playAnim()">Play Demo Animation</button>
    </div>

    <script>
        const el = {
            al: document.getElementById('arm-l'), fl: document.getElementById('fore-l'),
            ar: document.getElementById('arm-r'), fr: document.getElementById('fore-r'),
            bow: document.getElementById('bow-grp'),
            str: document.getElementById('bow-string'),
            bs: document.getElementById('bow-shape')
        };

        // Simple keyframes for demo (Uchiokoshi -> Daisan -> Hikiwake -> Kai)
        let t = 0;
        function playAnim() {
            t = 0;
            loop();
        }

        function loop() {
            t += 0.01;
            if (t > 4) t = 0; // Reset

            // Mock animation logic
            let la, lf, ra, rf, bt;

            if (t < 1) { // Uchiokoshi
                const p = t;
                la = -45 * p; lf = 10;
                ra = 45 * p; rf = -10;
                bt = 0;
            } else if (t < 2) { // Daisan
                const p = t - 1;
                la = -45 + (-15 * p); lf = 10 + (-10 * p);
                ra = 45 + (75 * p); rf = -10 + (90 * p);
                bt = 20 * p;
            } else if (t < 3) { // Hikiwake
                const p = t - 2;
                la = -60 + (-30 * p); lf = 0;
                ra = 120 + (15 * p); rf = 80 + (80 * p);
                bt = 20 + (70 * p);
            } else { // Kai
                la = -90; lf = 0;
                ra = 135; rf = 160;
                bt = 90;
            }

            el.al.setAttribute('transform', `translate(15, -65) rotate(${la})`);
            el.fl.setAttribute('transform', `translate(0, 30) rotate(${lf})`);

            el.ar.setAttribute('transform', `translate(-15, -65) rotate(${ra})`);
            el.fr.setAttribute('transform', `translate(0, 30) rotate(${rf})`);

            el.bow.setAttribute('transform', `translate(0, 28) rotate(${bt})`);

            // String draw logic (simplified)
            if (t > 2) {
                const draw = (t - 2) * 30;
                el.bs.setAttribute('d', `M0,-120 Q${draw},0 0,80`);
            } else if (t > 3) {
                el.bs.setAttribute('d', `M0,-120 Q30,0 0,80`);
            } else {
                el.bs.setAttribute('d', `M0,-120 Q0,0 0,80`);
            }

            requestAnimationFrame(loop);
        }
        playAnim();
    </script>
</body>

</html>